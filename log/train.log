================================================================================
Run started at 2026-01-13T20:29:31
Label mapping (canonical -> class_token):
  '3ml secretion' -> 'secretion'
  '3ml secretion (with hemf)' -> 'secretion'
  '3ml secretion m4' -> 'secretion'
  '5ml secretion' -> 'secretion'
  '5ml secretion m4' -> 'secretion'
  'no secretion' -> 'no_secretion'
  'no secretion sound' -> 'no_secretion'
  'no secretion sound (with hemf)' -> 'no_secretion'
Total segments: 65, train=35, val=30, groups=13
num_classes = 2 label2id = {'no_secretion': 0, 'secretion': 1}
Class counts: [15.0, 20.0] | sampler weights: [0.06666667014360428, 0.05000000074505806]
Epoch 01: lr=3.00e-04 | train_loss=0.6810 | full: loss=0.7823, acc=0.5000 | audio_only: loss=0.7192, acc=0.5000 | sensor_only: loss=0.7018, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
  -> New best full_acc=0.5000! Saved to checkpoints/best_multimodal.pt
Epoch 02: lr=3.00e-04 | train_loss=0.6830 | full: loss=0.8347, acc=0.5000 | audio_only: loss=0.7415, acc=0.5000 | sensor_only: loss=0.7099, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 03: lr=3.00e-04 | train_loss=0.6116 | full: loss=0.9397, acc=0.5000 | audio_only: loss=0.7948, acc=0.5000 | sensor_only: loss=0.7211, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 04: lr=3.00e-04 | train_loss=1.0581 | full: loss=0.7863, acc=0.5000 | audio_only: loss=0.7207, acc=0.5000 | sensor_only: loss=0.7106, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 05: lr=3.00e-04 | train_loss=0.7847 | full: loss=0.7103, acc=0.5000 | audio_only: loss=0.6946, acc=0.5000 | sensor_only: loss=0.7029, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 06: lr=1.50e-04 | train_loss=0.7349 | full: loss=0.7051, acc=0.5000 | audio_only: loss=0.6937, acc=0.5000 | sensor_only: loss=0.7021, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 07: lr=1.50e-04 | train_loss=0.6744 | full: loss=0.7101, acc=0.5000 | audio_only: loss=0.6952, acc=0.5000 | sensor_only: loss=0.7026, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 08: lr=1.50e-04 | train_loss=0.6704 | full: loss=0.7178, acc=0.5000 | audio_only: loss=0.6981, acc=0.5000 | sensor_only: loss=0.7034, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 09: lr=1.50e-04 | train_loss=0.7373 | full: loss=0.7172, acc=0.5000 | audio_only: loss=0.6976, acc=0.5000 | sensor_only: loss=0.7033, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 10: lr=7.50e-05 | train_loss=0.7738 | full: loss=0.7151, acc=0.5000 | audio_only: loss=0.6966, acc=0.5000 | sensor_only: loss=0.7031, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 11: lr=7.50e-05 | train_loss=0.7482 | full: loss=0.7113, acc=0.5000 | audio_only: loss=0.6953, acc=0.5000 | sensor_only: loss=0.7028, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 12: lr=7.50e-05 | train_loss=0.6765 | full: loss=0.7074, acc=0.5000 | audio_only: loss=0.6940, acc=0.5000 | sensor_only: loss=0.7024, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 13: lr=7.50e-05 | train_loss=0.7141 | full: loss=0.7025, acc=0.5000 | audio_only: loss=0.6931, acc=0.5000 | sensor_only: loss=0.7019, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 14: lr=3.75e-05 | train_loss=0.6751 | full: loss=0.7007, acc=0.5000 | audio_only: loss=0.6933, acc=0.5000 | sensor_only: loss=0.7017, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [15,  0]])
  Per-class precision/recall:
    no_secretion: precision=0.500, recall=1.000
    secretion: precision=0.000, recall=0.000
Epoch 15: lr=3.75e-05 | train_loss=0.7151 | full: loss=0.6985, acc=0.5333 | audio_only: loss=0.6945, acc=0.5000 | sensor_only: loss=0.7012, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[15,  0],
        [14,  1]])
  Per-class precision/recall:
    no_secretion: precision=0.517, recall=1.000
    secretion: precision=1.000, recall=0.067
  -> New best full_acc=0.5333! Saved to checkpoints/best_multimodal.pt
Epoch 16: lr=3.75e-05 | train_loss=0.7074 | full: loss=0.6974, acc=0.4333 | audio_only: loss=0.6973, acc=0.5000 | sensor_only: loss=0.7005, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 5, 10],
        [ 7,  8]])
  Per-class precision/recall:
    no_secretion: precision=0.417, recall=0.333
    secretion: precision=0.444, recall=0.533
Epoch 17: lr=3.75e-05 | train_loss=0.6835 | full: loss=0.6984, acc=0.4667 | audio_only: loss=0.7015, acc=0.5000 | sensor_only: loss=0.6999, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 1, 14]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.483, recall=0.933
Epoch 18: lr=3.75e-05 | train_loss=0.7010 | full: loss=0.7013, acc=0.5000 | audio_only: loss=0.7075, acc=0.5000 | sensor_only: loss=0.6993, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 19: lr=3.75e-05 | train_loss=0.7024 | full: loss=0.7058, acc=0.5000 | audio_only: loss=0.7147, acc=0.5000 | sensor_only: loss=0.6987, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 20: lr=1.87e-05 | train_loss=0.6995 | full: loss=0.7080, acc=0.5000 | audio_only: loss=0.7178, acc=0.5000 | sensor_only: loss=0.6985, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 21: lr=1.87e-05 | train_loss=0.6697 | full: loss=0.7102, acc=0.5000 | audio_only: loss=0.7208, acc=0.5000 | sensor_only: loss=0.6983, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 22: lr=1.87e-05 | train_loss=0.7050 | full: loss=0.7122, acc=0.5000 | audio_only: loss=0.7236, acc=0.5000 | sensor_only: loss=0.6983, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 23: lr=1.87e-05 | train_loss=0.6680 | full: loss=0.7154, acc=0.5000 | audio_only: loss=0.7277, acc=0.5000 | sensor_only: loss=0.6981, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 24: lr=1.00e-05 | train_loss=0.6676 | full: loss=0.7164, acc=0.5000 | audio_only: loss=0.7291, acc=0.5000 | sensor_only: loss=0.6981, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 25: lr=1.00e-05 | train_loss=0.7539 | full: loss=0.7162, acc=0.5000 | audio_only: loss=0.7292, acc=0.5000 | sensor_only: loss=0.6981, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 26: lr=1.00e-05 | train_loss=0.6454 | full: loss=0.7157, acc=0.5000 | audio_only: loss=0.7290, acc=0.5000 | sensor_only: loss=0.6982, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 27: lr=1.00e-05 | train_loss=0.6802 | full: loss=0.7152, acc=0.5000 | audio_only: loss=0.7286, acc=0.5000 | sensor_only: loss=0.6983, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 28: lr=1.00e-05 | train_loss=0.7581 | full: loss=0.7138, acc=0.5000 | audio_only: loss=0.7274, acc=0.5000 | sensor_only: loss=0.6984, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 29: lr=1.00e-05 | train_loss=0.6745 | full: loss=0.7128, acc=0.5000 | audio_only: loss=0.7265, acc=0.5000 | sensor_only: loss=0.6986, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Epoch 30: lr=1.00e-05 | train_loss=0.6702 | full: loss=0.7118, acc=0.5000 | audio_only: loss=0.7256, acc=0.5000 | sensor_only: loss=0.6987, acc=0.5000
  Confusion matrix (rows=true, cols=pred):
tensor([[ 0, 15],
        [ 0, 15]])
  Per-class precision/recall:
    no_secretion: precision=0.000, recall=0.000
    secretion: precision=0.500, recall=1.000
Early stopping triggered at epoch 30: no full-accuracy improvement for 5 epochs.
Run summary:
  Full acc mean=0.4978, best=0.5333
  Audio-only acc mean=0.5000, best=0.5000
  Sensor-only acc mean=0.5000, best=0.5000
Misclassified samples from best epoch:
  path=./data/MMDataset_segments_first5/251130/2025-11-30_23-21-23-SFM3300AW_24400737.edf__record_20251130T153457Z.wav/record_20251130T153457Z.wav__2025-11-30_23-21-23-SFM3300AW_24400737.edf_win00000.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251130/2025-11-30_23-21-23-SFM3300AW_24400737.edf__record_20251130T153457Z.wav/record_20251130T153457Z.wav__2025-11-30_23-21-23-SFM3300AW_24400737.edf_win00001.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251130/2025-11-30_23-21-23-SFM3300AW_24400737.edf__record_20251130T153457Z.wav/record_20251130T153457Z.wav__2025-11-30_23-21-23-SFM3300AW_24400737.edf_win00002.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251130/2025-11-30_23-21-23-SFM3300AW_24400737.edf__record_20251130T153457Z.wav/record_20251130T153457Z.wav__2025-11-30_23-21-23-SFM3300AW_24400737.edf_win00003.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251130/2025-11-30_23-21-23-SFM3300AW_24400737.edf__record_20251130T153457Z.wav/record_20251130T153457Z.wav__2025-11-30_23-21-23-SFM3300AW_24400737.edf_win00004.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251215/2025-12-14_23-15-13-SFM3300AW_24400737.edf__record_20251214T154318Z.wav/record_20251214T154318Z.wav__2025-12-14_23-15-13-SFM3300AW_24400737.edf_win00001.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251215/2025-12-14_23-15-13-SFM3300AW_24400737.edf__record_20251214T154318Z.wav/record_20251214T154318Z.wav__2025-12-14_23-15-13-SFM3300AW_24400737.edf_win00002.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251215/2025-12-14_23-15-13-SFM3300AW_24400737.edf__record_20251214T154318Z.wav/record_20251214T154318Z.wav__2025-12-14_23-15-13-SFM3300AW_24400737.edf_win00003.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251215/2025-12-14_23-15-13-SFM3300AW_24400737.edf__record_20251214T154318Z.wav/record_20251214T154318Z.wav__2025-12-14_23-15-13-SFM3300AW_24400737.edf_win00004.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251215/2025-12-14_23-15-13-SFM3300AW_24400737.edf__record_20251214T155422Z.wav/record_20251214T155422Z.wav__2025-12-14_23-15-13-SFM3300AW_24400737.edf_win00000.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251215/2025-12-14_23-15-13-SFM3300AW_24400737.edf__record_20251214T155422Z.wav/record_20251214T155422Z.wav__2025-12-14_23-15-13-SFM3300AW_24400737.edf_win00001.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251215/2025-12-14_23-15-13-SFM3300AW_24400737.edf__record_20251214T155422Z.wav/record_20251214T155422Z.wav__2025-12-14_23-15-13-SFM3300AW_24400737.edf_win00002.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251215/2025-12-14_23-15-13-SFM3300AW_24400737.edf__record_20251214T155422Z.wav/record_20251214T155422Z.wav__2025-12-14_23-15-13-SFM3300AW_24400737.edf_win00003.npz | true=secretion | pred=no_secretion
  path=./data/MMDataset_segments_first5/251215/2025-12-14_23-15-13-SFM3300AW_24400737.edf__record_20251214T155422Z.wav/record_20251214T155422Z.wav__2025-12-14_23-15-13-SFM3300AW_24400737.edf_win00004.npz | true=secretion | pred=no_secretion
